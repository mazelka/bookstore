%main.container
  %ul
  - flash.each do |_type, message|
    -if message.is_a?(Array)
      -message.each do |m|
        %li= m
    -else
      %li= message

  %h1.general-title-margin Ð¡atalog
  .hidden-xs.clearfix
    .dropdowns.pull-right
      .dropdown.width-240
        %a.dropdown-toggle.lead.small{href: "#", 'data-toggle': "dropdown", role: "button", 'aria-haspopup': "true", 'aria-expanded': "false"}
          = @active_sorting || "Newest first"
          %i.fa.fa-angle-down.dropdown-icon.pull-right
        %ul.dropdown-menu
          %li
            = link_to 'Newest first', books_path
          %li
            = link_to 'Popular first', books_popular_first_path
          %li
            = link_to 'Price: Low to high', books_price_low_to_high_path
          %li
            = link_to 'Price: High to low', books_price_high_to_low_path
    %ul.list-inline.pt-10.mb-25.mr-240
      %li.mr-35
        %a.filter-link{href: "/books"}
          All
          %span.badge.general-badge= @all_books
      - @popular_categories.each do |category|
        %li.mr-35
          %a.filter-link{href: "categories/#{category.id}"}
            = category.title
            %span.badge.general-badge= category.books.count

  - paginate(@books)
    - @books.in_groups_of(4) do |group|
    .row
    - group.each do |book|
      - if book
        .col-xs-6.col-sm-3
          .general-thumb-wrap
            .thumbnail.general-thumbnail
              %img.img-shadow.general-thumbnail-img{src: book.cover_url, alt: book.title}
              .thumb-hover
                .general-thumb-link-wrap
                  %a.thumb-hover-link.show-book{href: "/books/#{book.id}"}
                    %i.fa.fa-eye.thumb-icon{'aria-hidden': "true"}
                    = link_to((fa_icon 'shopping-cart', class: 'thumb-icon'), books_add_to_cart_path(id: book.id, quantity: 1), method: 'post', class: 'thumb-hover-link add-to-cart')
          .general-thumb-info
            %p.title= book.title
            %p.font-16.in-gold-500= Money.new(book.price, 'USD').format
            %span.divider-sm
            %p.lead.small= "#{book.author.first_name} #{book.author.last_name}"

  .text-center.mb-20
    - unless @books.last_page?
      = link_to_next_page(@books, 'View More', class: 'btn btn-primary')
      